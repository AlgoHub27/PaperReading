### 3.1 伯努利信源分析

考虑二元信源 $X \sim \text{Bern}(p)$，其解码输出 $\hat{X}$ 也约束为二元。我们以**汉明距离（Hamming distance）**作为失真度量 $\Delta(\cdot,\cdot)$，并以**总变差（Total Variation, TV）距离** $d_{\text{TV}}(\cdot,\cdot)$ 作为感知质量指标（注：对于伯努利信源，“感知质量”这一术语虽不直观，但为保持一致性仍沿用）。假设 $p \leq \frac{1}{2}$，当无感知约束时（即 $P = \infty$），问题退化为经典率失真函数，其解为：

  $R(D, \infty) = \begin{cases} H_b(p) - H_b(D) & D \in [0, p) \\0 & D \in [p, \infty) \end{cases}$      
其中 $H_b(\alpha)$ 是概率为 $\alpha$ 的伯努利变量的熵（Cover & Thomas, 2012）。

当引入感知约束 $P \leq p$ 时，率-失真-感知函数 $R(D,P)$ 分为三个区间（详见补充材料推导）：

   $R(D,P) = \begin{cases} H_b(p) - H_b(D) & D \in \mathcal{S}_1 \\2H_b(p) + H_b(p-P) - H_t\left(\frac{D-P}{2}, p\right) - H_t\left(\frac{D+P}{2}, q\right) & D \in \mathcal{S}_2 \\0 & D \in \mathcal{S}_3 \end{cases}$            
   
其中：
- $q = 1 - p$
- $H_t(\alpha, \beta)$ 表示概率为 $\alpha, \beta, 1-\alpha-\beta$ 的三元变量的熵
- 区间定义为：
  - $\mathcal{S}_1 = [0, D_1)$
  - $\mathcal{S}_2 = [D_1, D_2)$
  - $\mathcal{S}_3 = [D_2, \infty)$
  - $D_1 = \frac{P}{1 - 2(p - P)}$
  - $D_2 = 2pq - (q - p)P$

**关键观察**（图3）：
1. 当 $D = 0$ 时（无损压缩），所有曲线重合，此时 $p_{\hat{X}} = p_X$，感知质量完美。
2. 随着允许失真 $D$ 增大，率失真曲线开始分离。感知约束越严格（ $P$ 越小），曲线抬升越显著，尤其在低码率区域需大幅牺牲码率或失真。
3. 蓝色曲线（ $P = 0$ ）显示：通过适当增加失真，可在任意码率下实现完美感知质量。

---

### 3.2 一般信源的理论性质

对任意信源，率-失真-感知函数 $R(D,P)$ 满足以下性质（证明见补充材料）：

**定理1**：在以下假设下：
- **A1**: 散度 $d(\cdot,\cdot)$ 对其第二参数凸；
- **A2**: 函数 $k(z) = \mathbb{E}_{X \sim p_X}[\Delta(X,z)]$ 非恒定，

则 $R(D,P)$ 满足：
1. **单调性**：对 $D$ 和 $P$ 单调非增；
2. **凸性**：若 **A1** 成立，则 $R(D,P)$ 是凸函数；
3. **非重合性**：若 **A2** 成立，则 $R(\cdot, 0) \neq R(\cdot, \infty)$，即完美感知约束下率失真曲线必严格抬升。

**推论**：对非平凡失真度量（如MSE、SSIM），存在 $D_0$ 使得 $R(D_0, 0) > R(D_0, \infty)$，表明感知约束必然导致效率损失。

---

### 3.3 完美感知质量的失真上界（MSE情形）

**定理2**：当使用平方误差（MSE）作为失真度量时，完美感知质量（ $P = 0$ ）的率失真函数满足：

$R(D, 0) \leq R\left(\frac{1}{2}D, \infty\right)$

**解读**：
- 允许MSE最多增加2倍（PSNR降低3dB），可不增加码率实现完美感知。
- 图5展示了该上界：蓝色曲线 $R(D,0)$ 位于黑色虚线（经典率失真曲线）和灰色虚线（缩放曲线 $R(\frac{1}{2}D, \infty)$）之间。
- 实际应用中（如图像恢复），3dB的PSNR损失可换取显著感知质量提升（Blau et al., 2018; Ledig et al., 2017）。

---

### 图示说明

- **图3**：伯努利信源（ $p = 1/10$ ）的率-失真曲线。虚线为无感知约束（Shannon经典曲线），实线为不同感知约束下的抬升曲线。
- **图4**：三维率-失真-感知函数 $R(D,P)$ 的可视化：
  - (a) 等码率线显示低码率下失真与感知的强烈权衡；
  - (b) 固定码率时，感知质量提升需以失真增加为代价；
  - (c) 固定失真时，提升感知质量需更高码率。
- **图5**：定理2的几何解释，完美感知曲线受经典曲线及其缩放版本约束。