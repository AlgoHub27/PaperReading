# 重新思考有损压缩：率-失真-感知权衡

作者：Yochai Blau, Tomer Michaeli

## 摘要

有损压缩算法通常通过香农率失真理论的视角进行设计与分析，其目标是在给定比特率下实现尽可能低的失真（例如低MSE或高SSIM）。然而，近年来人们逐渐认识到“低失真”并非“高感知质量”的同义词，且优化其中一者往往以牺牲另一者为代价。基于这一认识，我们自然需要寻求一种将感知质量纳入考量的广义率失真理论。本文采用Blau & Michaeli (2018)提出的感知质量数学定义，研究码率（Rate）、失真（Distortion）与感知质量（Perception）三者间的权衡关系。我们表明，限制感知质量的高要求通常会导致率失真曲线的抬升，从而需要在码率或失真中做出牺牲。我们证明了这一三重权衡的若干基本性质，以伯努利信源为例推导了闭式解，并通过MNIST玩具示例进行了可视化展示。

---

## 1 引言

有损压缩技术在现代数字世界中无处不在，广泛用于图像、视频和音频的传输与存储。近年来，随着深度学习在这一领域的应用（如Toderici等人2016、2017，Balle等人2016、2017、2018等），有损压缩研究迎来了新的热潮。其理论基础源于**香农的率失真理论（Shannon, 1959），该理论分析了数据表示比特率与压缩重建失真之间的基本权衡（Cover & Thomas, 2012）**。

传统率失真理论假设降低失真是理想目标，但近年研究表明，仅最小化失真并不能保证解码信号具有高感知质量。例如，引入生成对抗网络（GAN）类损失可显著提升感知质量，但代价是失真增加（Tschannen等人2018，Agustsson等人2018）。类似现象在信号恢复任务（如去噪、超分辨率）中也被观察到：最小化失真会导致重建信号的分布偏离真实分布（Blau & Michaeli, 2018）。因此，亟需一种广义的率失真理论，将感知质量作为独立维度。

本文采用Blau & Michaeli (2018)的感知质量定义，证明了码率、失真与感知质量的三重权衡。核心发现是：**当强制要求高感知质量时，率失真曲线会抬升**（见图1）。换言之，提升感知质量需以牺牲码率或失真为代价。

---

## 2 背景

### 2.1 率失真理论

率失真理论分析从数据源 $X \sim p_X$ 中采样的数据，在压缩表示与重建失真之间的权衡。形式上，编码器-解码器对的输入 $X$ 与输出 $\hat{X}$ 的关系由条件分布 $p_{\hat{X}|X}$ 定义（见图2）。解码信号的期望失真定义为： $\mathbb{E}[\Delta(X,\hat{X})]$
其中 $\Delta: \mathcal{X} \times \hat{\mathcal{X}} \rightarrow \mathbb{R}^+$ 是全参考失真度量（如平方误差、深度特征L2距离、SSIM等）。

对于独立同分布（iid）信源 $X$，若期望失真被限制为 $D$，则最低可达码率由率失真函数刻画：
$R(D) = \min_{P_{\hat{X}|X}} I(X,\hat{X}) \quad \text{s.t.} \quad \mathbb{E}[\Delta(X,\hat{X})] \leq D$
其中 $I$ 表示互信息。该函数是单调非增且凸的。

### 2.2 感知质量

感知质量指输出信号 $\hat{x}$ 被人类感知为自然样本的程度，与其与输入 $x$ 的相似性无关。感知质量通常与输出分布 $p_{\hat{X}}$ 偏离自然分布 $p_X$ 的程度相关（见图2）。这一偏离可通过分布散度（如KL散度、Wasserstein距离）量化： $d(p_X, p_{\hat{X}})$
其中 $d(\cdot, \cdot)$ 是非负散度函数，且 $d(p,q)=0 \Leftrightarrow p=q$。

---

## 3 率-失真-感知权衡

### 3.1 伯努利信源示例

考虑二元信源 $X \sim \text{Bern}(p)$，解码输出 $\hat{X}$ 也为二元。以汉明距离为失真度量，总变差（TV）距离为感知指标。当无感知约束时（ $P=\infty$ ），率失真函数为：
    $R(D, \infty) = \begin{cases} H_b(p) - H_b(D) & D \in [0, p) \\0 & D \in [p, \infty)\end{cases}$     
当 $P \leq p$ 时，率-失真-感知函数 $R(D,P)$ 分为三段（公式6），具体行为见图3。结果表明，感知约束收紧时，率失真曲线显著抬升，尤其在低码率区域。

### 3.2 理论性质

**定理1**：对于一般信源，率-失真-感知函数 $R(D,P)$：
1. 对 $D$ 和 $P$ 单调非增；
2. 若散度 $d(\cdot, \cdot)$ 对其第二参数凸，则 $R(D,P)$ 是凸函数；
3. 若失真度量非平凡（如MSE、SSIM），则 $R(\cdot, 0) \neq R(\cdot, \infty)$，即完美感知约束下率失真曲线必抬升。

**定理2**：对MSE失真，完美感知质量（ $P=0$ ）的码率上界为：
$R(D,0) \leq R(\tfrac{1}{2}D, \infty)$
即允许MSE最多增加2倍（PSNR降低3dB），可不增加码率实现完美感知（见图5）。

---

## 4 实验验证

在MNIST数据集上，通过基于GAN的编码器-解码器网络验证理论（见图6-8）：
- **低码率下传统方法的感知缺陷**：仅优化MSE时（Shannon率失真曲线），重建图像模糊且多样性低（图6右）。
- **感知约束的作用**：引入Wasserstein距离约束后，重建图像更自然，但需接受更高失真或码率（图6）。
- **先进失真度量的局限性**：即使使用深度特征距离（公式11），率失真曲线仍抬升，但权衡强度有所减弱（图8）。

---

## 5 结论

**本文证明有损压缩中感知质量与码率、失真存在本质矛盾。任何要求解码信号分布接近源分布的操作，必然导致失真或码率上升。** 理论分析与实验表明，仅凭率失真曲线评价压缩算法可能具有误导性，需结合无参考感知质量指标。未来工作可将此框架扩展至视频编码等领域，并探索更贴近人类感知的散度度量。
